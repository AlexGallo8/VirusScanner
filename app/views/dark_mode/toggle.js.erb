const html = document.documentElement;
const isDark = <%= @is_dark.to_json %>;

// Remove any existing class first
html.classList.remove('dark');

// Then add if needed
if (isDark) {
    html.classList.add('dark');
}

// Update icons
const moonIcon = document.querySelector('.dark-icon');
const sunIcon = document.querySelector('.light-icon');

if (moonIcon && sunIcon) {
    moonIcon.style.display = isDark ? 'inline-block' : 'none';
    sunIcon.style.display = isDark ? 'none' : 'inline-block';
}

// Force style update
requestAnimationFrame(() => {
    document.body.style.transition = 'background-color 0.3s ease';
    document.body.style.backgroundColor = isDark ? 'rgb(17, 24, 39)' : 'rgb(255, 255, 255)';
});