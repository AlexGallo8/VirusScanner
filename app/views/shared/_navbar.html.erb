<style>
  @keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
  }
  @keyframes slideDown {
    from {
      transform: translateY(-20px);
      opacity: 0;
    }
    to {
      transform: translateY(0);
      opacity: 1;
    }
  }
  .animate-fade-in { animation: fadeIn 0.5s ease-out; }
  .animate-slide-down { animation: slideDown 0.5s ease-out; }
</style>

<%= javascript_import_module_tag "script" %>

<nav data-controller="navbar" class="bg-white shadow-md">
  <div class="container mx-auto px-4 py-3">
    <div class="flex justify-between items-center">
      <%= link_to root_path, class: "flex items-center" do %>
        <%= image_tag("logo_vs.png", class: "w-16 h-auto") %>
      <% end %>

      <button class="lg:hidden" id="mobile-menu-button">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path>
        </svg>
      </button>

      <div class="hidden lg:flex items-center space-x-4">
        <%= link_to "Home", root_path, class: "text-gray-700 hover:text-gray-900" %>
        <%= link_to "About", about_path, class: "text-gray-700 hover:text-gray-900" %>
        
        <div class="hidden lg:flex items-center space-x-4 login-buttons">
          <% if user_signed_in? %>
            <%= link_to "Edit Password", edit_password_path %>
            <%= button_to "Log out", session_path, method: :delete, style: 'background-color: #bbbb; color: white; border-radius: 5px;' %>
          <% else %>
            <%= link_to "Sign Up",
              new_registration_path( format: :turbo_stream ),
              # "data-controller": "turbo",
              # "data_action": "click->turbo#click",
              # "data_turbo_stream": "true"
              data: { 
                turbo_frame: "remote_modal",
                turbo: true,
                action: "click->turbo#click",
                turbo_stream: true 
              }
            %>
            <%# <%= link_to "Log in", new_session_path %>
            <%# <a
              href="#"
              id="modal-button"
              data-navbar-target="userAuthLink"
              class="block py-2 px-4 text-sm text-gray-700 hover:bg-gray-100" role="menuitem"
            >
              Sign Up
            </a> %>
            
            <%# <a href="#" data-header-target="userAuthLink" data-action="click->modal#showModal" class="block py-2 px-4 text-sm text-gray-700 hover:bg-gray-100" role="menuitem" tabindex="-1" id="user-menu-item-1">Log In</a> %>
          <% end %>
        </div>
      </div>
    </div>

    <div class="lg:hidden">
      <div class="hidden pt-2 pb-3 space-y-1" id="mobile-menu">
        <%= link_to "Home", root_path, class: "block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-50" %>
        <%= link_to "About", about_path, class: "block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-50" %>
        
        <% if current_user.present? %>
          <div class="px-3 py-2">
            <div id="mobile-user-button" data-clerk-component="userButton"></div>
          </div>
        <% else %>
          <button 
            onclick="Clerk.openSignIn()" 
            class="block w-full px-3 py-2 rounded-md text-base font-medium bg-black text-white hover:bg-gray-800"
          >
            Sign in
          </button>
          <button 
            onclick="Clerk.openSignUp()" 
            class="block w-full px-3 py-2 rounded-md text-base font-medium bg-gray-200 text-black hover:bg-gray-300"
          >
            Sign up
          </button>
        <% end %>
      </div>    
    </div>

    <div
        data-controller="modal"
        data-modal-target="wrapper"
        id="modal-wrapper"
        class="fixed inset-0 z-50 hidden"
    >
        <div
            data-modal-target="backdrop"
            id="modal-backdrop" 
            class="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity hidden"
        ></div>

        <div
            data-modal-target="panel"
            id="modal-panel"
            class="relative bg-white rounded-lg px-4 pt-5 pb-4 text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:max-w-xl sm:w-full sm:p-6 hidden"
        >
            <button 
                data-modal-target="closeButton"
                class="absolute top-4 right-4 text-gray-500 hover:text-gray-700"
            >
                <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                </svg>
            </button>

            <div class="sm:flex sm:items-start">
                <div class="mt-3 text-center sm:mt-0 sm:text-left w-full">
                    <h3 class="text-lg leading-6 font-medium text-gray-900" id="modal-title">
                        Log in or Sign up
                    </h3>
                    
                    <div class="mt-4">
                        <div class="relative">
                            <div class="absolute inset-0 flex items-center" aria-hidden="true">
                                <div class="w-full border-t border-gray-300"></div>
                            </div>
                            <div class="relative flex justify-center">
                                <span class="px-2 bg-white text-sm text-gray-500">Continue</span>
                            </div>
                        </div>

                        <div class="mt-6">
                            <label for="email" class="block text-sm font-medium text-gray-700">Email</label>
                            <div class="mt-1">
                                <input 
                                    type="email" 
                                    name="email" 
                                    id="email" 
                                    class="shadow-sm focus:ring-indigo-500 focus:border-indigo-500 block w-full sm:text-sm border-gray-300 rounded-md" 
                                    placeholder="you@example.com"
                                >
                            </div>
                        </div>

                        <div class="mt-6">
                            <button 
                                type="button" 
                                class="w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-indigo-600 text-base font-medium text-white hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:ml-3 sm:w-auto sm:text-sm"
                            >
                                Sign up
                            </button>
                        </div>

                        <div class="mt-6 relative">
                            <div class="absolute inset-0 flex items-center" aria-hidden="true">
                                <div class="w-full border-t border-gray-300"></div>
                            </div>
                            <div class="relative flex justify-center">
                                <span class="px-2 bg-white text-sm text-gray-500">or</span>
                            </div>
                        </div>

                        <div class="mt-6">
                            <button 
                                type="button" 
                                class="w-full inline-flex justify-center items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50"
                            >
                                <img 
                                    src="https://img.clerk.com/static/github.svg" 
                                    alt="GitHub" 
                                    class="h-5 w-5 mr-2"
                                >
                                Continue with GitHub
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

  </div>
</nav>

<%= render "shared/modal"%>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const mobileMenuButton = document.getElementById('mobile-menu-button');
    const mobileMenu = document.getElementById('mobile-menu');

    mobileMenuButton.addEventListener('click', () => {
      mobileMenu.classList.toggle('hidden');
      mobileMenu.classList.toggle('animate-slide-down');
    });
  });

  // document.addEventListener('DOMContentLoaded', () => {
  //   const modalButton = document.getElementById('modal-button');
  //   const modalWrapper = document.getElementById('modal-wrapper');
  //   const modalBackdrop = document.getElementById('modal-backdrop');
  //   const modalPanel = document.getElementById('modal-panel');

  //   modalButton.addEventListener('click', () => {
  //     modalWrapper.classList.toggle('hidden');
  //     modalBackdrop.classList.toggle('hidden');
  //     modalPanel.classList.toggle('hidden');
  //   });
  // });
</script>